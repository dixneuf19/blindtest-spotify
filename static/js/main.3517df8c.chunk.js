(this["webpackJsonpblindtest-spotify"]=this["webpackJsonpblindtest-spotify"]||[]).push([[0],{23:function(t,e,n){t.exports=n.p+"static/media/logo.79f6b6a0.svg"},24:function(t,e,n){t.exports=n.p+"static/media/loading.9d4cbf40.svg"},25:function(t,e,n){t.exports=n(55)},30:function(t,e,n){},32:function(t,e,n){},54:function(t,e,n){},55:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),s=n(22),c=n.n(s),o=(n(30),n(1)),i=n.n(o),u=n(2),l=n(7),h=n(8),f=n(10),p=n(9),m=n(11),d=n(23),v=n.n(d),k=n(24),g=n.n(k),w=(n(32),n(13)),b=n.n(w),y=(n(54),function(t){return r.a.createElement("button",{onClick:t.onClick},t.children)}),E="BQBo-m4KHdW1MbQOyMew3tCbWTi0A7fSKz0-Gq7noouY4vu_6pj1sVPvyqsVjplT96YeoNoX2MJKyx_VGa_lXRU0l9ABuZ0tmS-JqpfPskA3eibfz0q6KXpgcOfDEEj_f_XP4WY62sqg4g9V-hbSO2Z6",j="https://api.spotify.com/v1/me/tracks";function O(t){return Math.floor(Math.random()*t)}var x=function(t){function e(){return Object(l.a)(this,e),Object(f.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return this.props.track?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,this.props.track.name)," by ",r.a.createElement("b",null,this.props.track.artists[0].name)),r.a.createElement("div",null,this.props.sound?r.a.createElement(b.a,{url:this.props.track.preview_url,playStatus:b.a.status.PLAYING}):r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement(T,{images:this.props.track.album.images}))):r.a.createElement("div",null,r.a.createElement("b",null,"No song fetch"))}}]),e}(a.Component),T=function(t){function e(){return Object(l.a)(this,e),Object(f.a)(this,Object(p.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props.images[0].url;return r.a.createElement("img",{src:t,style:{width:400,height:400}})}}]),e}(a.Component),A=function(t){function e(){var t;return Object(l.a)(this,e),(t=Object(f.a)(this,Object(p.a)(e).call(this))).state={text:"",songsLoaded:!1,currentTrack:{},tracks:[],timeout:{}},t}return Object(m.a)(e,t),Object(h.a)(e,[{key:"checkAnswer",value:function(){var t=Object(u.a)(i.a.mark((function t(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e!==this.state.currentTrack.id){t.next=8;break}return clearTimeout(this.state.timeout),t.next=4,swal("Bravo","It was ".concat(this.state.currentTrack.name," by ").concat(this.state.currentTrack.artists[0].name),"succes");case 4:return t.next=6,this.resetGame();case 6:t.next=9;break;case 8:swal("Nope.","It was ".concat(this.state.currentTrack.name," by ").concat(this.state.currentTrack.artists[0].name),"warning");case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchOneSong",value:function(){var t=Object(u.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(j,"?limit=1&offset=").concat(e),{method:"GET",headers:{Authorization:"Bearer "+E}}).then((function(t){return t.json()})).then((function(t){return t.items[0].track}));case 2:return n=t.sent,t.abrupt("return",n.preview_url?n:this.fetchOneSong(e));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchNewSongs",value:function(){var t=Object(u.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(j,{method:"GET",headers:{Authorization:"Bearer "+E}}).then((function(t){return t.json()}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getShuffledTracks",value:function(t,e){return function(t){for(var e=t.length;e>0;){var n=O(e),a=t[--e];t[e]=t[n],t[n]=a}return t}(t.items.map((function(t){return t.track}))).filter((function(t,n){return n<e}))}},{key:"timeout",value:function(){var t=Object(u.a)(i.a.mark((function t(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,swal("Too long !","It was ".concat(this.state.currentTrack.name," by ").concat(this.state.currentTrack.artists[0].name),"warning");case 2:this.resetGame();case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"resetGame",value:function(){var t=Object(u.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("new songs with ".concat(this.state.res.total)),t.next=3,this.setRandomTracksFromAll(this.state.res.total);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setNewRandomTracks",value:function(){var t=this,e=this.getShuffledTracks(this.state.res,3);this.setState({currentTrack:e[O(3)],tracks:e,timeout:setTimeout((function(){return t.resetGame(t.state)}),3e4)})}},{key:"setRandomTracksFromAll",value:function(){var t=Object(u.a)(i.a.mark((function t(e){var n,a,r,s=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],a=0;case 2:if(!(a<3)){t.next=10;break}return t.next=5,this.fetchOneSong(O(e));case 5:r=t.sent,n.push(r);case 7:a++,t.next=2;break;case 10:this.setState({currentTrack:n[O(3)],tracks:n,timeout:setTimeout((function(){return s.resetGame(s.state)}),3e4)});case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(u.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchNewSongs();case 2:e=t.sent,this.setState({res:e}),this.setRandomTracksFromAll(this.state.res.total),this.setState({songsLoaded:!0,text:"Your library has ".concat(e.total," songs !")}),console.log(this.state);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:v.a,className:"App-logo",alt:"logo"}),r.a.createElement("h1",{className:"App-title"},"Bienvenue sur le Blindtest")),r.a.createElement("div",{className:"App-images"},this.state.songsLoaded?r.a.createElement("div",null,r.a.createElement("p",null,this.state.text),r.a.createElement(y,{onClick:function(){return t.setNewRandomTracks()}},"New songs")):r.a.createElement("img",{src:g.a,className:"App-loading",alt:"loading"})),r.a.createElement("div",{className:"App-buttons"},this.state.tracks.map((function(e,n){return r.a.createElement(y,{onClick:function(){return t.checkAnswer(e.id)},key:n},r.a.createElement(x,{track:e,sound:e.id===t.state.currentTrack.id}))}))))}}]),e}(a.Component),N=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function S(t){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(t){console.error("Error during service worker registration:",t)}))}c.a.render(r.a.createElement(A,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/blindtest-spotify",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/blindtest-spotify","/service-worker.js");N?function(t){fetch(t).then((function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):S(t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t):S(t)}))}}()}},[[25,1,2]]]);
//# sourceMappingURL=main.3517df8c.chunk.js.map